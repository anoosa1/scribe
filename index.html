<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scribe</title>
  <link rel="stylesheet" href="/src/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>

<body>
  <div id="app">
    <!-- Left Toolbar (desktop) / Slide-up panel (mobile) -->
    <aside class="toolbar" id="toolbar">
      <div class="toolbar-inner" id="toolbar-inner">
        <div class="toolbar-section">
          <span class="section-label">Tools</span>
          <div class="tools-grid">
            <button id="pencil" class="tool-btn active" title="Pencil (P)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
              </svg>
            </button>
            <button id="eraser" class="tool-btn" title="Eraser (E)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 20H7L3 16C2 15 2 13 3 12L13 2L22 11L20 20Z"></path>
                <path d="M17 17L7 7"></path>
              </svg>
            </button>
            <button id="line" class="tool-btn" title="Line (L)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="5" y1="19" x2="19" y2="5"></line>
              </svg>
            </button>
            <button id="rectangle" class="tool-btn" title="Rectangle (R)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              </svg>
            </button>
            <button id="circle" class="tool-btn" title="Circle (C)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
              </svg>
            </button>
            <button id="text" class="tool-btn" title="Text (T)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="4 7 4 4 20 4 20 7"></polyline>
                <line x1="9" y1="20" x2="15" y2="20"></line>
                <line x1="12" y1="4" x2="12" y2="20"></line>
              </svg>
            </button>
            <button id="pan" class="tool-btn" title="Pan (Space + Drag)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"></path>
                <path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"></path>
                <path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8"></path>
                <path
                  d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15">
                </path>
              </svg>
            </button>
          </div>
        </div>

        <div class="toolbar-section">
          <span class="section-label">Colors</span>
          <input type="color" id="color-picker" value="#000000">
          <div class="palette">
            <div class="color-swatch active" style="background-color: #000000" data-color="#000000"></div>
            <div class="color-swatch" style="background-color: #ffffff" data-color="#ffffff"></div>
            <div class="color-swatch" style="background-color: #ef4444" data-color="#ef4444"></div>
            <div class="color-swatch" style="background-color: #f97316" data-color="#f97316"></div>
            <div class="color-swatch" style="background-color: #eab308" data-color="#eab308"></div>
            <div class="color-swatch" style="background-color: #22c55e" data-color="#22c55e"></div>
            <div class="color-swatch" style="background-color: #3b82f6" data-color="#3b82f6"></div>
            <div class="color-swatch" style="background-color: #8b5cf6" data-color="#8b5cf6"></div>
          </div>
        </div>

        <div class="toolbar-section">
          <span class="section-label">Size: <span id="size-value">5</span>px</span>
          <input type="range" id="brush-size" min="1" max="50" value="5">
        </div>

        <div class="toolbar-section">
          <span class="section-label">Theme</span>
          <select id="theme-select" class="canvas-size-select">
            <option value="default">Default</option>
            <option value="base16-atelier">Atelier</option>
            <option value="base16-eighties">Eighties</option>
            <option value="catppuccin">Catppuccin</option>
            <option value="gruvbox">Gruvbox</option>
            <option value="gruvbox-light">Gruvbox Light</option>
            <option value="nord">Nord</option>
            <option value="nord-light">Nord Light</option>
            <option value="onedark">One Dark</option>
          </select>
        </div>

        <div class="toolbar-section">
          <span class="section-label">Canvas</span>
          <div class="canvas-options">
            <select id="canvas-size" class="canvas-size-select">
              <option value="1920x1080">1920 √ó 1080</option>
              <option value="2560x1440">2560 √ó 1440</option>
              <option value="3000x2000" selected>3000 √ó 2000</option>
              <option value="4000x3000">4000 √ó 3000</option>
              <option value="custom">Custom...</option>
            </select>
            <label class="dark-mode-toggle" id="dark-mode-label" title="Dark Mode">
              <input type="checkbox" id="dark-mode-checkbox">
              <span class="toggle-track">
                <span class="toggle-icon sun">‚òÄÔ∏è</span>
                <span class="toggle-icon moon">üåô</span>
                <span class="toggle-thumb"></span>
              </span>
            </label>
          </div>
        </div>

        <div class="toolbar-section actions">
          <button id="undo" class="action-btn" title="Undo">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 7v6h6"></path>
              <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>
            </svg>
            <span>Undo</span>
          </button>
          <button id="clear" class="action-btn danger" title="Clear Canvas">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
            <span>Clear</span>
          </button>
          <button id="reset-view" class="action-btn" title="Reset View">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
              <path d="M3 3v5h5"></path>
            </svg>
            <span>Reset View</span>
          </button>
          <button id="import-image" class="action-btn" title="Import Image">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <span>Import Image</span>
          </button>
          <button id="export-png" class="action-btn" title="Export as PNG">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            <span>Export PNG</span>
          </button>
        </div>
      </div>

      <input type="file" id="image-file-input" accept="image/*" style="display: none;">
    </aside>

    <!-- Mobile backdrop overlay -->
    <div class="mobile-backdrop hidden" id="mobile-backdrop"></div>

    <!-- Mobile Bottom Toolbar -->
    <div class="mobile-toolbar" id="mobile-toolbar">
      <button class="mobile-tool-btn active" data-tool="pencil" title="Pencil">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
        </svg>
      </button>
      <button class="mobile-tool-btn" data-tool="eraser" title="Eraser">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 20H7L3 16C2 15 2 13 3 12L13 2L22 11L20 20Z"></path>
          <path d="M17 17L7 7"></path>
        </svg>
      </button>
      <button class="mobile-tool-btn" data-tool="line" title="Line">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="5" y1="19" x2="19" y2="5"></line>
        </svg>
      </button>
      <button class="mobile-tool-btn" data-tool="rectangle" title="Rectangle">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        </svg>
      </button>
      <button class="mobile-tool-btn" data-tool="circle" title="Circle">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
        </svg>
      </button>
      <button class="mobile-tool-btn" data-tool="text" title="Text">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="4 7 4 4 20 4 20 7"></polyline>
          <line x1="9" y1="20" x2="15" y2="20"></line>
          <line x1="12" y1="4" x2="12" y2="20"></line>
        </svg>
      </button>
      <button class="mobile-tool-btn" data-tool="pan" title="Pan">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"></path>
          <path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"></path>
          <path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8"></path>
          <path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15">
          </path>
        </svg>
      </button>
      <!-- Undo -->
      <button class="mobile-tool-btn" id="mobile-undo" title="Undo">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 7v6h6"></path>
          <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>
        </svg>
      </button>
      <!-- More / Panel Toggle -->
      <button class="mobile-tool-btn mobile-more-btn" id="mobile-panel-toggle" title="More options">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="4" y1="6" x2="20" y2="6"></line>
          <line x1="4" y1="12" x2="20" y2="12"></line>
          <line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Main Canvas Area -->
    <main class="canvas-area">
      <div class="canvas-container" id="canvas-container">
        <canvas id="whiteboard"></canvas>
        <!-- Remote cursor overlays -->
        <div id="remote-cursors"></div>
      </div>

      <!-- Zoom Controls -->
      <div class="zoom-controls">
        <button id="zoom-out" class="zoom-btn">‚àí</button>
        <span id="zoom-level">100%</span>
        <button id="zoom-in" class="zoom-btn">+</button>
      </div>

      <!-- Room Info -->
      <div class="room-info">
        <div class="room-id-container">
          <span>Room:</span>
          <code id="room-id-display">Connecting...</code>
          <button id="copy-room-link" class="icon-btn" title="Copy Link">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="14" height="14" x="8" y="8" rx="2" ry="2" />
              <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" />
            </svg>
          </button>
        </div>
        <div class="users-connected">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          <span id="user-count">1</span>
          <span class="connection-status" id="connection-status" title="Connecting...">
            <span class="status-dot connecting"></span>
          </span>
        </div>
      </div>

      <!-- Text Input Overlay -->
      <div id="text-input-overlay" class="text-input-overlay hidden">
        <div class="text-input-container">
          <input type="text" id="text-input" placeholder="Enter text..." autocomplete="off">
          <div class="text-input-actions">
            <button id="text-cancel" class="text-btn">Cancel</button>
            <button id="text-confirm" class="text-btn primary">Add</button>
          </div>
        </div>
      </div>

      <!-- Canvas Size Modal -->
      <div id="canvas-size-overlay" class="text-input-overlay hidden">
        <div class="text-input-container">
          <span class="section-label" style="margin-bottom: 12px; display: block;">Custom Canvas Size</span>
          <div class="canvas-size-inputs">
            <div class="size-input-group">
              <label for="canvas-width-input">Width</label>
              <input type="number" id="canvas-width-input" value="3000" min="100" max="10000" autocomplete="off">
            </div>
            <span class="size-separator">√ó</span>
            <div class="size-input-group">
              <label for="canvas-height-input">Height</label>
              <input type="number" id="canvas-height-input" value="2000" min="100" max="10000" autocomplete="off">
            </div>
          </div>
          <div class="text-input-actions">
            <button id="canvas-size-cancel" class="text-btn">Cancel</button>
            <button id="canvas-size-confirm" class="text-btn primary">Apply</button>
          </div>
        </div>
      </div>

      <!-- Toast -->
      <div id="toast" class="toast hidden">Link copied!</div>
    </main>
  </div>
  <script type="module" src="/src/main.js"></script>
</body>

</html>